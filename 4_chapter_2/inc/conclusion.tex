In this work, we presented an efficient algorithm for the appropriate placement of distance restraints in free-energy calculations performed with the linked dual topology approach. Linked dual topologies have the advantage that larger transformations can be simulated in a straightforward manner (e.g. no soft bonds are required), while reducing the sampling complexity. 
With the developed RestraintMaker Python package, distance restraint sets can be created from a script or at GUI level, and written out in the GROMOS and GROMACS formats or in JSON format.
The greedy algorithm is a graph-based approach and can be straightforwardly applied to molecules with (semi)rigid cores (typically aromatic or aliphatic rings). The only required user inputs are the number of restraints $n_\text{res}$ to be selected and the maximum distance between the restrained atoms $d_\text{res}$ .
%%%%%ToyModelFun
The performance of the algorithm was evaluated using toy systems (particle clouds) and compared to two brute-force approaches. In view of the results, the greedy algorithm represents a good trade-off between computing time and accuracy.

%%%%%free energy
RestraintMaker was used to select optimal distance restraints for the calculation of relative hydration free energies with both TI (pairwise) and RE-EDS (multi-state). In all cases, good agreement between the different free-energy methods and with experiment was observed. Detailed analysis of the conformational sampling also indicated that the effect of the possible distortions induced by the distance restraints on the conformations is negligible. Even when restraining the benzene core and the cyclohexane core of two molecules together, accurate free-energy differences were obtained and the distributions of the pseudo torsional angles of the cyclohexane ring were nearly identical with those from plain MD simulations.
The results with RE-EDS highlighted the superior sampling efficiency of the method. In the future, we will apply RestraintMaker in RBFE calculations with RE-EDS.

%As an outlook, we would like to point out that our future work on multistate methods will be expanding on this work, and we are looking forward to using the approach for more complex systems. Interesting challenges include increasing the number of states significantly or going to larger molecules.

