In the computational studies, two pairs of structurally similar cyclic peptides were selected, i.e., Nleu-5R/Nleu-5S and Nleu-2R/Nleu-2S (Figure \ref{fig:permCMols}). 
The first pair presents a ``permeability cliff'', i.e., the two peptides show a large difference in the passive permeability in the PAMPA assay (Nleu-5R: $−log(P_e)$~=~5.4; Nleu-5S: $−log(P_e)$~=~7.2), despite a high structural similarity. 
In contrast, the second pair is similar in both structure and permeability (Nleu-2R: $−log(P_e)$~=~6.1; Nleu-2S: $−log(P_e)$~=~5.8). 
For each of these four peptides, $250$ starting coordinates were generated using the macrocycle variant of the OMEGA conformer generator from OpenEye. \cite{Hawkins2012, Hawkins2010, Poongavanam2018}
Conformers were energy-minimized for maximum $2000$ steps with the steepest descent \cite{Ruder2016} approach using the GROMOS software package \cite{Schmid2012} with the GROMOS 54A7 force field. \cite{Schmid2011} 
Each minimized starting conformation was solvated in a cubic box of simple-point-charge (SPC) water \cite{Berendsen1981} (on average, $4172$ solvent molecules) or chloroform \cite{Tironi1994} (on average, $980$ solvent molecules). 
For each system, an MD simulation of $101~$ns length was performed under isothermal–isobaric (NPT) conditions with the leap-frog integration algorithm \cite{Hockney1970, Gunsteren1988} and a time step of $2$~fs. 
The first 1 ns was discarded as equilibration. Bond lengths were constrained with SHAKE \cite{Ryckaert1977} and a relative tolerance of $10^{–4}$. 
Nonbonded interactions were calculated using a twin-range scheme with a short-range cutoff of $0.8$~nm and a long-range cutoff of $1.4$~nm. 
The electrostatic nonbonded contributions beyond the long-range cutoff were calculated with the reaction-field \cite{Tironi1995} approach, setting the dielectric permittivity to 61.0 \cite{Heinz2001} for water, and to 4.8 \cite{Tironi1994} for chloroform. 
The temperature was kept constant at $300$~K using the weak coupling scheme \cite{Berendsen1984} and a coupling time of $0.1~\text{ps}$. 
The pressure was kept at $1.031$~bar ($1$~atm) with the same type of algorithm, a coupling time of $0.5~\text{ps}^{–1}$, and an isothermal compressibility of $0.001654~\text{bar}^{–1}$ for chloroform and $0.0004575~\text{bar}^{–1}$ for water. 
Translational motion of the center of mass of the simulation box was removed every $2$~ps. Energies and coordinates were written every $5$~ps.

Trajectory analysis was performed with PyEmma \cite{Scherer2015} and MDTraj \cite{Mcgibbon2015}. 
The selection of features for the structural clustering consisted of the distances between all pairs of polar atoms and the backbone torsional angles, resulting in total $57$ features. 
This selection was reduced to three to five dimensions (depending on the peptide) with TICA \cite{Molgedey1994} using a cumulative variance of $0.9$ as criterion and a TICA correlation lag time of $50$~ps. 
Based on these TICs, the frames were clustered with a common nearest neighbor (CNN) algorithm \cite{Keller2010, Weiss2021} using a cutoff of $0.2$ and a similarity of $20$. 
Comparison of selected clusters with NMR experiments was performed with the GROMOS++ package of programs. \cite{Eichenberger2011}
The coefficients for the Karplus curve were taken from Vögeli \textit{et al.} \cite{Voegeli2015}
Analysis of hydrogen bonds and torsional angles was performed with MDTraj. 
The 3D-PSA was calculated with our implementation \cite{Witek2019} of the workflow in Ref.~\citenum{Tyagi2018} using PyMol \cite{Delano2020}.
Statistical analysis of all results was carried out using the Python packages Pandas, NumPy and SciPy.\cite{Virtanen2020}

